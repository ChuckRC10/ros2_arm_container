<?xml version="1.0"?>
<!-- 
  This URDF file has been updated to include collision and inertial properties
  for all physical links, which is essential for physics simulation.
-->
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="arm_model">
  
  <!-- *********************** LINKS *********************** -->
  <!-- Xacro Properties -->
  <xacro:property name="base_width" value="0.3"/>
  <xacro:property name="base_height" value="0.15"/>
  <xacro:property name="arm_width" value="0.1"/>
  <xacro:property name="arm_length" value="0.5"/>
  <!-- Base Link -->
  <link name="base_link">
    <visual>
      <geometry>
        <box size="${base_width} ${base_width} ${base_height}"/>
      </geometry>
      <material name="grey">
        <color rgba="0.5 0.5 0.5 1.0"/>
      </material>
    </visual>
    <!-- Collision geometry is usually identical to the visual geometry -->
    <collision>
      <geometry>
        <box size="${base_width} ${base_width} ${base_height}"/>
      </geometry>
    </collision>
    <!-- Inertial properties define mass and rotational inertia for the physics engine -->
    <inertial>
      <mass value="2.0"/>
      <!-- Inertia tensor for a box, calculated for the given mass and size -->
      <inertia ixx="0.01875" ixy="0.0" ixz="0.0" iyy="0.01875" iyz="0.0" izz="0.03"/>
    </inertial>
  </link>

  <!-- Virtual Link for 2-DOF Joint: No visual or collision needed -->
  <link name="base_arm1_virtual_link">
    <inertial>
      <mass value="1e-5"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>

  <!-- First Arm Link -->
  <link name="arm1_link">
    <visual>
      <origin xyz="0 0 ${arm_length/2}"/> <!-- Centered the origin for an arm_length length box -->
      <geometry>
        <box size="${arm_width} ${arm_width} ${arm_length}"/>
      </geometry>
      <material name="blue">
        <color rgba="0.2 0.2 0.8 1.0"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 ${arm_length/2}"/>
      <geometry>
        <box size="${arm_width} ${arm_width} ${arm_length}"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 ${arm_length/2}"/> <!-- The origin for inertia should be at the center of mass -->
      <mass value="1.0"/>
      <inertia ixx="0.0217" ixy="0.0" ixz="0.0" iyy="0.0217" iyz="0.0" izz="0.0017"/>
    </inertial>
  </link>

  <!-- Second Arm Link -->
  <link name="arm2_link">
    <visual>
      <origin xyz="0 0 ${arm_length/2}"/> <!-- Centered the origin for an arm_length length box -->
      <geometry>
        <box size="${arm_width} ${arm_width} ${arm_length}"/>
      </geometry>
       <material name="silver">
        <color rgba="0.75 0.75 0.75 1.0"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 ${arm_length/2}"/>
      <geometry>
        <box size="${arm_width} ${arm_width} ${arm_length}"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 ${arm_length/2}"/>
      <mass value="1.0"/>
      <inertia ixx="0.0217" ixy="0.0" ixz="0.0" iyy="0.0217" iyz="0.0" izz="0.0017"/>
    </inertial>
  </link>

  <!-- *********************** JOINTS *********************** -->

  <joint name="base_to_arm1_virtual" type="continuous">
    <parent link="base_link"/>
    <child link="base_arm1_virtual_link"/>
    <axis xyz="0 0 1"/>
    <origin xyz="0 0 ${base_height/2}"/> <!-- Origin is at the top surface of the base box -->
  </joint>

  <!-- Corrected the syntax from 'joint name' to '<joint name' -->
  <joint name="arm1_virtual_to_arm1" type="continuous">
    <parent link="base_arm1_virtual_link"/>
    <child link="arm1_link"/>
    <axis xyz="0 1 0"/> <!-- Changed axis to Y for a pan-tilt setup -->
    <origin xyz="0 0 0"/> <!-- Origin is relative to the virtual link -->
  </joint>

  <joint name="arm1_to_arm2" type="continuous">
    <parent link="arm1_link"/>
    <child link="arm2_link"/>
    <axis xyz="0 1 0"/> <!-- Changed axis to Y for an elbow-style joint -->
    <!-- Origin places the second link at the end of the first link -->
    <origin xyz="0 0 ${arm_length}"/> 
  </joint>
</robot>
